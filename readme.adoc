= K-MultiPart
:source-highlighter: highlightjs
:lib-version: 1.0.0

image:https://img.shields.io/github/license/foxcapades/lib-k-multipart[GitHub]
image:https://img.shields.io/badge/docs-dokka-green[link="https://foxcapades.github.io/lib-k-multipart/dokka/1.0.0/"]
image:https://img.shields.io/maven-central/v/io.foxcapades.lib/k-multipart[Maven Central, link="https://search.maven.org/artifact/io.foxcapades.lib/k-multipart"]

Kotlin `multipart/form-data` `BodyPublisher` implementation for the
link:https://docs.oracle.com/en/java/javase/11/docs/api/java.net.http/java/net/http/HttpClient.html[Java `HttpClient` API].

.build.gradle.kts
[source, kotlin, subs="verbatim,attributes"]
----
  implementation("io.foxcapades.lib:k-multipart:{lib-version}")
----

== Usage

[source,kotlin]
----
  val client = HttpClient.newHttpClient()

  val body = MultiPart.createBody {
    withPart {
      fieldName = "foo"
      withBody("bar")
    }

    withPart {
      fieldName = "fizz"
      withBody(File("buzz"))
    }
  }

  val res = client.send(
    HttpRequest.newBuilder()
      .uri(URI("http://something.com"))
      .header("Content-Type", body.getContentTypeHeader())
      .POST(body.makePublisher())
      .build(),
    HttpResponse.BodyHandlers.ofString()
  )
----